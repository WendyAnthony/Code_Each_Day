---
title: "Draft ER390 Project Proposal"
subtitle: "Visualizing HAT's GOE Monitoring Data"
author: "Wendy Anthony"
date: "2025/09/04"
output:
  html_document:
    df_print: paged
    toc: yes
    toc_depth: 3
    toc_float: yes
    number_sections: yes
  pdf_document:
    latex_engine: xelatex
    toc: yes
  word_document:
    toc: yes
    toc_depth: '3'
# mainfont: Monaco #default Times Roman
# fontsize: 12pt # use with mainfont: Monaco
---

```{r, setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

```{r, load-libraries, echo=FALSE, results=FALSE, results='hide', message=FALSE}
library(shiny)
library(tidyverse)
library(plotly)
library(leaflet)
library(DiagrammeR)
```
\newpage
# The Idea behind submitting this project proposal
Nancy Shackelford (RNS Director) suggested that creating a data visualization tool for HAT GOE Monitoring for a suitable ER390 Final Project. I propose starting Fall 2025 term. While waiting for HAT to prepare to share data in October, I could continue the coding work I started in August (36+ hours), to create reproducible code snippets for use when HAT data is ready to be shared. I could also create R code to help with October data cleaning task. See *[Proposed Gantt Timeline Chart](#gantt)*


# Background 
Data used for this proposal is from two tables in the report that HAT used for modelling their GOE Monitoring Project (Malloff & Shackelford, 2024). Comparing monitoring results from multiple restoration projects requires consistent measurements of vegetation composition (e.g. native and exotic species cover), which may help identify responses to stressors affecting already compromised and rare Garry Oak Ecosystems. Representing data in a visual manner can help make complex data more understandable than a tables of numbers, and may reveal patterns or trends resulting from different restoration management actions (Malloff & Shackelford, 2024). Data visualization can represent abstract information visually, by allowing for data exploration and analysis, modelling of restoration management alternatives, data-based story-telling, and communicating potential insights, to help understand and make restoration management decisions. Using RMarkdown to generate reports helps create reproducible research methods (McKay, 2020).  
° Malloff, J., & Shackelford, N. (2024). <i>Feeling the Pulse: Monitoring methods and initial outcomes in oak meadow ecosystems.</i> Restoration Futures Lab at the University of Victoria.  
° McKay, S. K. (2020). <i>Data visualization for ecological analysis and restoration.</i> US Army Corp of Engineers:Ecosystem Management and Restoration Research Program (EMRRP) Webinar Series. https://cw-environment.erdc.dren.mil/webinars/20Feb5-EcoMod-DataViz.pdf  


# Project Partner
I spoke to Vanessa Brownlee, Habitat Restoration Coordinator at Habitat Acquisition Trust (HAT) Social on 2025-08-27, who was very interested in my proposed project idea, and seemed willing to consider letting me start in Fall 2025, with data available later in October. I also later spoke briefly to Board Chair Andy MacKinnon, who seemed keen to know of my interest in doing my RNS Final Project with HAT and looks forward to learning more. I'm prepared to be guided by HAT's preferences, timing, and data protocols.

# Project Goals and Overall Purpose
I propose to create a customized, automatic coding and reporting tool, using open-source R package libraries, for use by non-coders for data formatting and interactively visualizing data collected at multiple sites for HAT Garry Oak Ecosystem (GOE) Monitoring Program, including tutorial instructions, to help determine any patterns in collected data, and provide an interactive way to communication information about the data. This project proposal was created using code in RMarkdown, to showcase types of visualizations tools and reports that I propose to offer HAT, after adapting code to reflect HAT's data.

# Project Objectives (SMART actionable targets) {#objectives}
- See *[WorkFlowchart, Figure 1](#workflow)*, and Gantt Chart *[Proposed Timeline, Figure 2](#gantt)*
- **Analyze collected data** to understand underlying structure, ensure use of consistent naming protocols for variables, and format data to be usable for use with data visualization code.
- **Write data visualization code**, using RStudio, RMarkdown, and RShiny, to create appropriate visualizations to enable a better understanding of the collected data.
- **Customize data tools** to reflect consistent styles using HAT's colours, logos, and plotting themes.
- **Create RMarkdown documents**, with reproducible code, for non-coders, to automatically download and format data, create data visualizations, and produce customized reports.
- **Create scaleable data visualization tools** that can have more sites added, with different measuring and sensitivity criteria (e.g. First Nations GOE sites), and multi-year data.
- **Track individual site differences** using variables and other metrics or indices that HAT measures.
- **Create custom R functions** to read, analyze, and plot data, as basis for HAT R package. 
- **Create tools for multi-season use**  to ensure consistent use of data variable names, and to incorporate any lessons learned in the process of working with it data in year one.
- **Create an interactive, browser-based Shiny App** User-chosen, custom-make data visualization plots, maps, and statistical analysis; select location(s) and variables; download results.
- **Recognize sensitive and confidential nature of any First Nations data** by creating separate data visualization files, code, and reports appropriate to individual land project goals.

# Project Methods for HAT Data visualization {#methods}
- See *[WorkFlowchart, Figure 1](#workflow)*, and Gantt Chart *[Proposed Timeline, Figure 2](#gantt)*
- Continue research for Shiny reactive code to make interactive data choices (e.g. drop-down lists), respond to choices, filter results. Interactive choices will eventually react to variable selections to make custom-made visualizations and analysis with only a few clicks 
- Sign any HAT data confidentiality agreements as may be required
- Consult with HAT restoration monitor team to explore and understand the nature of the collected data, data format (forms, spreadsheets), the variables that are being measured, any indices to be calculated using the collected data, what questions they would like to explore with the data
- Create a Project folder, with subfolders for R scripts, raw data, processed data, images, reports, meta data (units, descriptions, etc); create file and variable naming protocols
- Analyze and clean data, check for errors, inconsistencies; calculate indices values from raw data
- Create data visualization plot charts that appropriately reflect nature of variables being measured
- Documents my methods, successes, and failures in the process of the project
- Continued research to find appropriate R coding methods, and to contribute to writing my final paper

# Proposed Deliverables {#deliverables} 
See *[WorkFlowchart, Figure 1](#workflow)*, and *[Proposed Timeline, Figure 2](#gantt)*; All deliverables created using RStudio

**Data Visualizations**: Including data tables, plots, interactive maps; for individual sites, comparing sites, or confidentially for First Nations; See *[Example Visualization](#visualizations)* in next section 

**RMarkdown Data Processing Document**: Data downloading, data cleaning and preparation; create data visualizations; Create reports in HTML, pdf, or Word with plot output images, or code snippets

**Customizations**: Create customized colour palette for Plot themes, App, Reports; add HAT logo

**Shiny App Interactive Data Viz Tool**: Data processed with RMarkdown document; choose data variables to visualize in tables, plot, maps; https://goe-interact.shinyapps.io/Test-Shiny-GOE-Monitor/ 

**Tutorials for using Data visualization Tools**: customized, easy to understand 

**Create Report Templates**: Customized fpr individual site, total project reports, or as requested by HAT

**Best practises for data files**: Ensure consistency in naming files, variables, file folder structure, etc.

**Create Customized Functions for HAT**: Functions could form core of a HAT-specific R Package library

**Presentation**: Completed project presented to community partner HAT; including slide show, live demonstrations of Data Visualization Tools, and final copy of my written report when approved to be published.

**Written Report**: Due 2026-08-15, document project; publish in Ecorestoration: RNS Technical Series  

\newpage
# Workflow Graph {#workflow}
- See *[Objectives](#objectives), [Methods](#methods), and [Deliverables](#deliverables)*
- The workflow shows how the raw data, from HAT monitoring measurements, would be transformed and included in code to produce a variety of deliverable products.
- This graph is made with code from DiagrammeR, using a colour-blind friendly colour palette.

```{r ER390-2-mermaid-graph-shapes, echo=FALSE}
DiagrammeR::DiagrammeR("
graph TB

A1[Wendy]
A2[Nancy - RNS]
A3[Vanessa - HAT]

A((ER390 Project))
C((R Code))
D(Raw Data)
E(Transformed & Filtered Data)
F[Variable Names]
H[HAT]
K{RMarkdown}
RC[Reusable Code]
V{DataVisualizations}
RT{Report Templates}
MR{Make Reports}
IA{Interactive Web Shiny App}
S(Shiny app)
D1((Deliverables))
D2(Data Best practises)
D3(Reports)
D4(Data Vizualizations)
D5(Instruction Tutorials)
D6(RMarkdown Documents)
D7(Customizations)
P(Presentation to HAT)
RP(R Package)
W(Written Report)

 A1-.->|begins|A
 A1-.->|consult with|A2
 A2-.->|provide feedback|A1
 A3-.->|provide feedback|A1
 A2-.->|liaise with|A3
 A3-.->|share Data|A1
 A3-.->|Request Features|A1
 A3-.->|share HAT data|D
 A-- Wendy creates -->C
 A-- for -->H
 A-->D1
 C-- analyze & clean -->D
 D-- Data Transformations results in -->E
 C-- code in -->K
 K-- to create -->V
 V-- using -->F
 F-- in -->E
 MR-- with -->K
 V-- used in -->IA
 IA-- acts reactively with -->E
 IA-- produces user-chosen -->V
 V-- with -->IA
 K-- produces -->RC
 RC-- used in -->V
 RC-- used in -->RT
 K-- produces -->RT
 D1-- e.g. -->D6
 D1-- e.g. -->D4
 D1-- e.g. -->S
 D1-- e.g. -->D2
 D1-- e.g. -->D5
 D1-- e.g. -->D7
 D1-- e.g. -->D3
 D1-- e.g. -->RP
 D1-- e.g. -->P
 D1-- e.g. -->W
 
 style A1 fill:#f6e8c3, stroke:#333, stroke-width:2px  
 style A3 fill:#f6e8c3, stroke:#333, stroke-width:2px  
 style A2 fill:#f6e8c3, stroke:#333, stroke-width:2px  
 style A fill:#80cdc1, stroke:#333, stroke-width:3px  
 style C fill:#35978f, stroke:#333, stroke-width:1px  
 style D fill:#c7eae5, stroke:#333, stroke-width:3px  
 style D1 fill:#80cdc1, stroke:#333, stroke-width:1px  
 style D2 fill:#dfc27d, stroke:#333, stroke-width:1px  
 style D3 fill:#dfc27d, stroke:#333, stroke-width:1px  
 style D4 fill:#dfc27d, stroke:#333, stroke-width:1px  
 style D5 fill:#dfc27d, stroke:#333, stroke-width:1px  
 style D6 fill:#dfc27d, stroke:#333, stroke-width:1px  
 style D7 fill:#dfc27d, stroke:#333, stroke-width:1px  
 style E fill:#c7eae5, stroke:#333, stroke-width:3px  
 style F fill:#c7eae5, stroke:#333, stroke-width:3px  
 style H fill:#dfc27d, stroke:#333, stroke-width:2px  
 style IA fill:#dfc27d, stroke:#333, stroke-width:1px  
 style K fill:#dfc27d, stroke:#333, stroke-width:2px  
 style MR fill:#dfc27d, stroke:#333, stroke-width:2px  
 style P fill:#dfc27d, stroke:#333, stroke-width:1px  
 style RC fill:#c7eae5, stroke:#333, stroke-width:3px  
 style RP fill:#dfc27d, stroke:#333, stroke-width:1px 
 style RT fill:#dfc27d, stroke:#333, stroke-width:1px  
 style S fill:#dfc27d, stroke:#333, stroke-width:1px  
 style V fill:#dfc27d, stroke:#333, stroke-width:1px  
 style W fill:#dfc27d, stroke:#333, stroke-width:1px  

")
# #3C8937 Forest Green
 #99cc6e

# colourblind friendly colours
# https://colorbrewer2.org/#type=diverging&scheme=BrBG&n=9


#bf812d
#dfc27d
#f6e8c3
#f5f5f5
#c7eae5
#80cdc1
#35978f

# D2(Data - Best practises protocols)
# D5(Tutorial: PDF, HTML, video, Instruction manual)
# D21[File Protocols - naming, saving ]
# D31[Templates, auto creation]
# D41[Automatic Coding Templates]
# D51[Instructions for use]
# P1[to HAT]
# RP1[create R library with reusable functions]
# R1[customized automatically created]
# S1[Interactive user-created data viz]
# W1[final writeup]
```
Figure 1: Project method workflow diagram for ER390 data visualization for HAT

\newpage
# Proposed Timeline (Look at SMART Objectives) {#gantt}
- red coloured items are considered critical  
- grey items are completed  
- Note: This chart was coded with DiagrammeR using an imported csv file of data
- See [Objectives](#objectives), [Methods](#methods), and [Deliverables](#deliverables)


```{r gantt, echo=FALSE, include=TRUE, message=FALSE}
ER390_gantt <- read.csv("data/ER390-Gantt-Tasks.csv", header = TRUE, sep = ",")
# str(ER390_gantt)
# NOTE: dates need to be chr in order for Gantt code to work properly
# names(ER390_gantt)
# # convert start and end dates from chr to date 
# changes way date is displayed in Gantt
# but now I loose my Gantt 
 # ER390_gantt$start <- as.Date(ER390_gantt$start)
 # ER390_gantt$end <- as.Date(ER390_gantt$end)
# str(ER390_gantt)

library(tidyr)
library(dplyr)
library(DiagrammeR)

mermaid(
  paste0(
    # mermaid "header", each component separated with "\n" (line break)
    "gantt", "\n",
    "dateFormat  YYYY-MM-DD", "\n",
    "title ER390 HAT Data Viz Project Proposed Timeline", "\n",
    # unite the first two columns (task & status) and separate them with ":"
    # then, unite the other columns and separate them with ","
    # this will create the required mermaid "body"
    paste(ER390_gantt %>%
            unite(i, task, status, sep = ":") %>%
            unite(j, i, pos, start, end, sep = ",") %>%
            .$j,
          collapse = "\n"
    ), "\n"
  )
)
  
```

Figure 2: Gantt Proposed ER390 Timeline 

\newpage
***

# Example Data Visualization Results {#visualizations}
## Data download and formatting
- These example visualizations use GOE monitoring data from report by Malloff & Shackelford (2024)
- Data (in excel or csv format) is uploaded 
- Data is formatted, saved, and managed to be useful for creating visualizations
- The code has been hidden for the HTML report, highlighting only the resulting plots, though is visible in PDF document. The R code has been documented using hidden comments.

## Load Site Data
<details><summary><b><i>Click open to see R code for `Loading Data`</i></b></summary><p>
```{r, load-data}
# Load data and create 2 data frames
# Load Site Data
geo_eccc <- read.csv("data/SiteData-TEST-GOE-Monitor.csv", header = TRUE, sep = ",")
# Load Site Details
Sites_eccc <- read.csv("data/SiteDetails-TEST-GOE-Monitor.csv", header = TRUE, sep = ",")
```

</p></details>

```{r, echo=FALSE, results=FALSE, results='hide', message=FALSE}
# Percentage_ns <- geo_eccc$Proportion_of_native_species * 100
```

## Data Cleaning and Transformation
<details><summary><b><i>Click open to see R code for `Data Cleaning and Transformation`</i></b></summary><p>
```{r, data-cleaning}
# create new column with proportions changed to percentage as a whole number
Percentage_ns <- geo_eccc$Proportion_of_native_species * 100

# add-new column for Percentages
geo_eccc <- cbind(geo_eccc, Percentage_ns)

# arrange order of site names
Sites_eccc_1 <- Sites_eccc %>% arrange(Sites_eccc$Site)
geo_eccc_1 <- geo_eccc %>% arrange(geo_eccc$Site)

# bind 2 dataframes together
# this requires Sites rows from both data frames to be in alphabetical order
## to assign the data rows correctly 
geo_eccc_sites <- cbind(Sites_eccc_1, geo_eccc_1)

# Remove duplicate columns resulting from binding 2 data frames
geo_eccc_sites_1 <- geo_eccc_sites[c(-9,-10)]

# Rename columns to remove dot-format
names(geo_eccc_sites_1)[names(geo_eccc_sites_1) == "Land.Manager"] <- "Land_Manager"
names(geo_eccc_sites_1)[names(geo_eccc_sites_1) == "Main.Restoration.Type"] <- "Main_Restoration_Type"
names(geo_eccc_sites_1)[names(geo_eccc_sites_1) == "Restoration.Intensity"] <- "Restoration_Intensity"
names(geo_eccc_sites_1)[names(geo_eccc_sites_1) == "Area.ha"] <- "Area_ha"

# write csv file with combined data 
## to create new data file which is used for creating the visualizations
write.csv(geo_eccc_sites_1, "data/geo_eccc_all_site_data.csv", row.names = FALSE)
```
</p></details>

```{r, add-column, echo=FALSE, results=FALSE, results='hide', message=FALSE}
#geo_eccc <- cbind(geo_eccc, Percentage_ns)
```

```{r, arange-order-df, echo=FALSE, results=FALSE, results='hide', message=FALSE}
# Sites_eccc_1 <- Sites_eccc %>% arrange(Sites_eccc$Site)
# geo_eccc_1 <- geo_eccc %>% arrange(geo_eccc$Site)
```

```{r, cbind-arranged-df, echo=FALSE, results=FALSE, results='hide', message=FALSE}
#geo_eccc_sites <- cbind(Sites_eccc_1, geo_eccc_1)
```

```{r, remove-duplicate-columns, echo=FALSE, results=FALSE, results='hide', message=FALSE}
# geo_eccc_sites_1 <- geo_eccc_sites[c(-9,-10)]
```

```{r, rename-columns-baser, echo=FALSE, results=FALSE, results='hide', message=FALSE}
# names(geo_eccc_sites_1)[names(geo_eccc_sites_1) == "Land.Manager"] <- "Land_Manager"
# names(geo_eccc_sites_1)[names(geo_eccc_sites_1) == "Main.Restoration.Type"] <- "Main_Restoration_Type"
# names(geo_eccc_sites_1)[names(geo_eccc_sites_1) == "Restoration.Intensity"] <- "Restoration_Intensity"
# names(geo_eccc_sites_1)[names(geo_eccc_sites_1) == "Area.ha"] <- "Area_ha"
```

```{r, create-csv-combined-datasets, echo=FALSE, results=FALSE, results='hide', message=FALSE}
# write.csv(geo_eccc_sites_1, "data/geo_eccc_all_site_data.csv", row.names = FALSE)
```

\newpage

# Data Visualization Example Results

## Data Table 
- using data from Malloff & Shackelford (2024) 

### Full Data Table

- The full table is too wide for use in pdf because current variable names are too long.

```{r, data table_html, echo=FALSE}
# for html
DT::datatable(geo_eccc_sites_1)
```

### Table Head of Site Information

```{r data-table-pdf-sites, echo=FALSE, warning=FALSE}
# - table is too wide for pdf because variable names are too long

# kable not supported by word
## for pdf use kableExtra::kable to print small version of head
#   kableExtra::kable_styling(latex_options = "hold_position", font_size = 6)

kableExtra::kable(
  head(Sites_eccc_1), booktabs = TRUE, linesep = ""
) %>%
  kableExtra::kable_styling(latex_options = "hold_position", font_size = 6)
```

### Table Head of Site Data

```{r data-table-pdf-data, echo=FALSE, warning=FALSE}
# - table is too wide for pdf because variable names are too long

# kable not supported by word
## for pdf use kableExtra::kable to print small version of head
#   kableExtra::kable_styling(latex_options = "hold_position", font_size = 6)

kableExtra::kable(
  head(geo_eccc_1), booktabs = TRUE, linesep = ""
) %>%
  kableExtra::kable_styling(latex_options = "hold_position", font_size = 6)
```

Figures 3,4,5: Example Data Tables

\newpage
## Map of Site Locations

### Leaflet Map with Circle Markers 
- The Leaflet Map is created using R code in RMarkdown.
- Data  is summarized in map marker popups with summary of site data

```{r Leaflet_map_circle_markers_sized_radius, echo=FALSE}
# not supported by docx format
# , fig.align = 'center'

geo_eccc_sites_1 <- read.csv("data/geo_eccc_all_site_data.csv")

library(dplyr)
library(leaflet)
library(htmlwidgets) # for responsive web map

title <- '<p style="text-align: center; height: 30px; ">
<span style="font-size:10px;font-weight:bold; background-color: rgba(255, 255, 255, 0.9;");>ECCC GOE 2023 Monitoring Sites</span><br>
<span style="font-size:8px;font-style:italic; background-color: rgba(255, 255, 255, 0.9;">(Malloff & Shackelford, 2024)</span></p>'
 
pal <- colorFactor(c("#d7191c", "#2c7bb6"), domain = c("Saanich Peninsula", "Gulf Islands"))

ECCC_map_2 <- leaflet(geo_eccc_sites_1) %>%
  addProviderTiles("Esri.WorldImagery") %>%
  addCircleMarkers(
             ~ Lng, ~ Lat, 
         
             radius = ~ifelse(Subregion == "Saanich Peninsula", 8, 8),
    fillColor = ~pal(Subregion),
    color = "black",
    weight = 3, # size of circle border
    stroke = TRUE, fillOpacity = 0.5,
             popup = paste0("<b>ECCC GOE 2023 Monitoring Data</b>", "<br>", "<i>(Malloff & Shackelford, 2024)</i>", "<br><br>",
               "<b>Site:</b> ", "<b>", geo_eccc_sites_1$Site, "</b>", "</b>", "<br><br>", "<b>Subregion:</b> ", geo_eccc_sites_1$Subregion, "<br>",
                        "<b>Latitude:</b> ", geo_eccc_sites_1$Lat, "<br>", "<b>Longitude:</b> ", geo_eccc_sites_1$Lng,  "<br><br>",
                        "<b>Land Manager:</b> ", geo_eccc_sites_1$Land_Manager, "<br>",
                        "<b>Main Restoration:</b> ", geo_eccc_sites_1$Main_Restoration_Type, "<br>",
                        "<b>Restoration Intensity:</b> ", geo_eccc_sites_1$Restoration_Intensity, "<br>",
                        "<b> Area:</b> ", geo_eccc_sites_1$Area_ha, " ha",
                        "<br><br>",
                        "<b>Proportion of native species:</b> ", geo_eccc_sites_1$Proportion_of_native_species, "<br>",
                        "<b>Cultural species richness:</b> ", geo_eccc_sites_1$Cultural_species_richness, "<br>",
                        "<b>Exotic species:</b> ", geo_eccc_sites_1$Exotic_species, "<br>",
                        "<b>Trampling:</b> ", geo_eccc_sites_1$Trampling, "<br>",
                        "<b>Herbivory:</b> ", geo_eccc_sites_1$Herbivory, "<br>",
                        "<b>Composite Index:</b> ", geo_eccc_sites_1$Composite_Index, "<br>")) %>%
  setView(-123.44799, 48.64919, 10) %>%
  # add controls
  addMiniMap(width = 100, height = 100, zoomLevelOffset = -4) %>%
  addControl(title, position = "topright") 

# Display map
ECCC_map_2
saveWidget(ECCC_map_2, "output/ECCC_map_2.html")
```
Figure 6: Interactive Leaflet Map with Example Sites Data
\newpage

## Subregion Plots
- These plot compare monitoring variable measurement results between two Subregions.

```{r, plots_Exotic_species, echo=FALSE, results=FALSE, results='hide', include=FALSE, message=FALSE}
subregion_exsp <- ggplot(geo_eccc, 
                    aes(x = Subregion, y = Exotic_species)) +
                    geom_violin(fill = "seagreen2") +
                    geom_boxplot(width = 0.1, fill = "sandybrown") +
                    theme_minimal() + #get rid of grey background and tick marks 
                    theme(legend.position="none") + #remove legend 
                    theme(axis.text.x = element_text(vjust = 1, size = 9)) +
                    labs(title='Plotting Subregion by Exotic Species',
                      subtitle='ECCC',
                      x = "Subregion", y = "Exotic Species")
subregion_exsp
# plotly won't work here
```


```{r, plots_Percentage_ns, echo=FALSE, results=FALSE, results='hide', include=FALSE, message=FALSE}

subregion_nsp <- ggplot(geo_eccc, 
                    aes(x = Subregion, y = Percentage_ns)) +
                    geom_violin(fill = "seagreen2") +
                    geom_boxplot(width = 0.1, fill = "sandybrown") +
                    theme_minimal() + #get rid of grey background and tick marks 
                    theme(legend.position="none") + #remove legend 
                    theme(axis.text.x = element_text(vjust = 1, size = 9)) +
                    labs(title='Plotting Subregion by Percentage of Native Species',
                      subtitle='ECCC',
                       x = "Subregion", y = "Percentage Native Species")
subregion_nsp
# plotly won't work here
```

### Violin/Bar Plot: Compare Subregions Exotic and Native Species

```{r, cowplot_violin_subr, echo=FALSE}
library(cowplot)

subregion_exsp_1 <- subregion_exsp + labs(title='Exotic Species',
                      subtitle='ECCC (Malloff & Shackelford, 2024)'
                      )

subregion_nsp_1 <- subregion_nsp + labs(title='Native Species',
                      subtitle='ECCC (Malloff & Shackelford, 2024)',
                      caption = "Chart by Wendy Anthony \n 2025-08-27")

plot_grid(subregion_exsp_1, subregion_nsp_1, labels = "AUTO")
```

Figure 7: Violin / bar plot comparing variables of 2 Subregions

\newpage

## Site Plots

### Point Plot: Compare Individual Sites by Restoration Intensity
- Sites are ordered by the level of restoration intensity, ranging from high to minimal 
- This plotly-style chart becomes interactive by clicking data points for view a tool-tip of data results. 

```{r, plots_site_Restoration_Intensity_order_point_1, echo=FALSE}

# Step 1
desired_levels <- c("high", "moderate", "low", "minimal")
# create new df to create desired levels
geo_eccc_sites_2 <- geo_eccc_sites_1
# this changes data type from character to factor
geo_eccc_sites_2$Restoration_Intensity <- factor(geo_eccc_sites_1$Restoration_Intensity, levels = desired_levels)

# step 2
geo_eccc_sites_2 <- geo_eccc_sites_2[order(geo_eccc_sites_2$Restoration_Intensity),]

# values in order now -- ?? how to change to reverse order 
site_restInt_x <- ggplot(geo_eccc_sites_2,
       aes(x = reorder(Site, 
                       -desc(Restoration_Intensity)), 
           y = reorder(Restoration_Intensity, desc(Restoration_Intensity)), color = Subregion)) +
  # reorder y variable axis
  # https://stackoverflow.com/questions/28391850/reverse-order-of-discrete-y-axis-in-ggplot2s
# y = Restoration_Intensity
                    geom_point(shape = 18, size = 2) +
  #geom_bar(stat="identity") +
#  scale_fill_brewer(palette = "Dark2") +
                    theme_minimal() + #get rid of grey background and tick marks 
                    theme(legend.position="bottom") + 
                    theme(axis.text.x = element_text(angle = 25, vjust = 1, hjust=1, size = 7)) +
                    labs(title='Plot Site Restoration Intensity',
                      subtitle='ECCC (Malloff & Shackelford, 2024)',
                      caption = "Chart by Wendy Anthony \n 2025-08-26",
                      x = "Site", y = "Restoration Intensity")

# ggplot
# site_restInt_x

# ggplotly(site_restInt_x)
leg <- list(
  font = list(
    family = "sans-serif",
    size = 8,
    color = "#000"))
# xanchor = "center", too far left
plot <- ggplotly(site_restInt_x)
plot <- plot %>% layout(legend = list(leg, x = 0.15, y = -0.5, orientation = 'h', size = 0.025))  
plot <- plot %>% layout(legend = leg)

#plot
ggplotly(plot)
```
Figure 8: Point Plot of Restoration Intensity of Example Sites



